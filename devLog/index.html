<!DOCTYPE html>
<html>
<head lang="fr">
    <meta charset="UTF-8">
    <title>DevLog</title>
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="devlog.css">
</head>
<body>
    <div id="log">
        <ul id="list">
            <li>
                <section class="head">
                    <div class="expand"></div>
                    Improvements
                    <button class="add-button">Add</button>
                </section>
                <section class="content">
                </section>
            </li>
            <li>
                <section class="head">
                    <div class="expand"></div>
                    Improvements
                    <button class="add-button">Add</button>
                </section>
                <section class="content">
                    <p>Pouet pouet pouet</p>
                </section>
            </li>
            <li>
                <section class="head">
                    <div class="expand"></div>
                    Improvements
                    <button class="add-button">Add</button>
                </section>
                <section class="content">
                </section>
            </li>
            <li>
                <section class="head">
                    <div class="expand"></div>
                    Improvements
                    <button class="add-button">Add</button>
                </section>
                <section class="content">
                </section>
            </li>
        </ul>
        <hr>
        <section id="add">
            <select>
                <option>Improvements</option>
                <option>New Features</option>
            </select>
            <textarea rows="5"></textarea>
            <button>ADD</button>
        </section>
    </div>
</body>
<script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="js/notificationAgent.js"></script>
<script type="text/javascript">
    $(".expand").click(function(){
        $(this).parent().parent().children(".content").last().slideToggle();
    });
    $(".add-button").click(function(){

        var category = $(this).parent().parent().children(".content").last();
        if(category.children(".input-wrapper").length == 0) {
            category.prepend("<div class='input-wrapper'><input></div>");
            category.prepend("<img src='icons/ic_publish_black_24dp.png' class='send' />");
            category.prepend("<div class='close'></div>");
            $(".close", category).click(function(){
                $(this).next().remove();
                $(this).next().remove();
                $(this).remove();
            });
            $('input', category).keyup(function(event){
                if(event.keyCode == 13){
                    category.prepend("<p>" + $(this).val() + "</p>");
                    $(".close", category).next().remove();
                    $(".close", category).remove();
                    $(this).parent().remove();
                }
            });
            $('.send', category).click(function(){
                category.prepend("<p>" + $('input', category).val() + "</p>");
                $(this).next().remove();
                $(this).prev().remove();
                $(this).remove();
            });
            category.slideDown();
        }
        else
            category.slideDown();
        category.children().children("input").last().focus();
    });
</script>
</html>